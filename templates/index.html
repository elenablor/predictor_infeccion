<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Predicción de Infección Postquirúrgica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h2 class="mb-4 text-center">Predicción de riesgo de infección</h2>
        <form method="post" class="card p-4 shadow">

            <div class="mb-3">
                <label class="form-label">Edad del paciente</label>
                <input type="number" class="form-control" name="EDAD" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Sexo del paciente</label>
                <select class="form-select" name="Sexo" required>
                    <option value="0">Mujer</option>
                    <option value="1">Hombre</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Tipo de prótesis implantada</label>
                <select class="form-select" name="PROCED" required>
                    <option value="1">Prótesis de cadera</option>
                    <option value="2">Prótesis de rodilla</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Duración del procedimiento (en minutos)</label>
                <input type="number" class="form-control" name="Proc.Duración" required>
            </div>

            <div class="mb-3">
                <label class="form-label">¿Es una reintervención?</label>
                <select class="form-select" name="Proc.Esreintervención" required>
                    <option value="0">No</option>
                    <option value="1">Sí</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Tipo de intervención</label>
                <select class="form-select" name="TipoIntervención" required>
                    <option value="1">Primaria Electiva</option>
                    <option value="2">Primaria Urgente</option>
                    <option value="3">Revisión Electiva</option>
                    <option value="4">Revisión Urgente</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Quirófano</label>
                <select class="form-select" name="QUIROFANO" required>
                    <option value="1">Quirófano 1</option>
                    <option value="2">Quirófano 2</option>
                    <option value="3">Quirófano 3</option>
                    <option value="4">Quirófano 4</option>
                    <option value="5">Quirófano 5</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Clasificación ASA (riesgo anestésico)</label>
                <select class="form-select" name="ASA" required>
                    <option value="1">ASA I – Paciente sano</option>
                    <option value="2">ASA II – Enfermedad sistémica leve</option>
                    <option value="3">ASA III – Enfermedad sistémica grave</option>
                    <option value="4">ASA IV – Enfermedad grave que amenaza la vida</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Profilaxis antibiótica (tipo)</label>
                <select class="form-select" name="PROFILAXIS" required>
                    <option value="Adecuada/Aprobada">Adecuada: antibiótico correcto y a tiempo</option>
                    <option value="Inadecuada por inicio">Inadecuada por inicio: fuera del tiempo recomendado</option>
                    <option value="Inadecuada por elección">Inadecuada por elección: antibiótico incorrecto</option>
                    <option value="No administrada">No administrada</option>
                </select>
            </div>
            
            <div class="mb-3">
                <label class="form-label">Grado de contaminación quirúrgica</label>
                <select class="form-select" name="CONTAMINACION" required>
                    <option value="Limpia">Limpia – Sin infección, técnica estéril mantenida</option>
                    <option value="Contaminada">Contaminada – Técnica estéril comprometida o heridas abiertas</option>
                    <option value="Sucia">Sucia – Infección activa presente antes de la cirugía</option>
                </select>
            </div>


            <button type="submit" class="btn btn-primary w-100">Predecir Riesgo</button>

        </form>

        {% if prediction == 'error' %}
        <div class="alert alert-warning mt-4">
            No se ha podido calcular el riesgo. Revisa que todos los campos estén correctamente rellenados.
        </div>
        {% elif prediction is not none %}
        <div class="alert mt-4 {{ 'alert-danger' if prediction == 1 else 'alert-success' }}">
            Riesgo de infección: <strong>{{ 'ALTO' if prediction == 1 else 'BAJO' }}</strong>
        </div>
        {% endif %}
        

    </div>
</body>
</html>

